{"ast":null,"code":"var _jsxFileName = \"/Users/geonil/Desktop/react-new-hooks/src/components/useOptimistic/index.tsx\",\n  _s = $RefreshSig$(),\n  _s2 = $RefreshSig$();\nimport { useEffect, useState, useRef, useOptimistic } from 'react';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst deliverMessage = async message => {\n  await new Promise(response => setTimeout(response, 1000));\n  return message;\n};\nconst UseOptimisticComponent = () => {\n  _s();\n  const [messages, setMessages] = useState([{\n    text: `Hello!!`,\n    sending: false,\n    key: 1\n  }]);\n  const sendMessage = async message => {\n    const sentMessage = await deliverMessage(message);\n    setMessages(messages => [...messages, {\n      text: sentMessage\n    }]);\n  };\n  return /*#__PURE__*/_jsxDEV(ParentComponent, {\n    messages: messages,\n    sendMessage: sendMessage\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 31,\n    columnNumber: 9\n  }, this);\n};\n_s(UseOptimisticComponent, \"k3U+QbhINjey7lUAu6D/+HQ8msA=\");\n_c = UseOptimisticComponent;\nconst ParentComponent = ({\n  messages,\n  sendMessage\n}) => {\n  _s2();\n  const formRef = useRef(null);\n  const [optimisticState, addOptimistic] = useOptimistic(messages, (state, newMessage) => [...state, {\n    text: newMessage,\n    sending: true,\n    key: state.length + 1\n  }]);\n  const formAction = async formData => {\n    addOptimistic(formData.get(`message`));\n    formRef.current.reset();\n    await sendMessage(formData);\n  };\n  useEffect(() => {\n    console.log(optimisticState);\n  }, [optimisticState]);\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [optimisticState.map((message, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [message.text, !!message.sending && /*#__PURE__*/_jsxDEV(\"small\", {\n        children: \" (Sending...)\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 56,\n        columnNumber: 43\n      }, this)]\n    }, index, true, {\n      fileName: _jsxFileName,\n      lineNumber: 54,\n      columnNumber: 17\n    }, this)), /*#__PURE__*/_jsxDEV(\"form\", {\n      action: formAction,\n      ref: formRef,\n      children: [/*#__PURE__*/_jsxDEV(\"input\", {\n        type: \"text\",\n        name: \"message\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"submit\",\n        children: \"Add Message\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 61,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true);\n};\n_s2(ParentComponent, \"BtyQxtq8wbJN2ghgsPHK/vfyFwg=\", false, function () {\n  return [useOptimistic];\n});\n_c2 = ParentComponent;\nexport default UseOptimisticComponent;\nvar _c, _c2;\n$RefreshReg$(_c, \"UseOptimisticComponent\");\n$RefreshReg$(_c2, \"ParentComponent\");","map":{"version":3,"names":["useEffect","useState","useRef","useOptimistic","jsxDEV","_jsxDEV","Fragment","_Fragment","deliverMessage","message","Promise","response","setTimeout","UseOptimisticComponent","_s","messages","setMessages","text","sending","key","sendMessage","sentMessage","ParentComponent","fileName","_jsxFileName","lineNumber","columnNumber","_c","_s2","formRef","optimisticState","addOptimistic","state","newMessage","length","formAction","formData","get","current","reset","console","log","children","map","index","action","ref","type","name","_c2","$RefreshReg$"],"sources":["/Users/geonil/Desktop/react-new-hooks/src/components/useOptimistic/index.tsx"],"sourcesContent":["import { useEffect, useState, useRef, useOptimistic } from 'react';\n\ntype Messages = {\n    text: string,\n    sending?: boolean,\n    key?: number\n}[]\n\ntype ParentProps = { \n    messages: Messages, \n    sendMessage: (message: string) => Promise<void> \n}\n\nconst deliverMessage = async (message: string) => {\n    await new Promise((response) => setTimeout(response, 1000));\n    return message;\n}\n\nconst UseOptimisticComponent = () => {\n    const [messages, setMessages] = useState<Messages>([\n        { text: `Hello!!`, sending: false, key: 1 }\n    ]);\n\n    const sendMessage = async (message: string) => {\n        const sentMessage = await deliverMessage(message);\n\n        setMessages((messages) => [...messages, { text: sentMessage }]);\n    };\n\n    return (\n        <ParentComponent messages={messages} sendMessage={sendMessage} />\n    );\n};\n\nconst ParentComponent = ({ messages, sendMessage } : ParentProps) => {\n    const formRef = useRef(null);\n    const [optimisticState, addOptimistic] = useOptimistic<Messages, string>(\n        messages, \n        (state, newMessage) => [...state, { text: newMessage, sending: true, key: state.length + 1 }]\n    );\n\n    const formAction = async (formData: FormData) => {\n        addOptimistic(formData.get(`message`) as string);\n        formRef.current.reset();\n        \n        await sendMessage(formData);\n    }\n    useEffect(() => {\n        console.log(optimisticState);\n    }, [optimisticState])\n    return (\n        <>\n            {optimisticState.map((message, index) => (\n                <div key={index}>\n                    {message.text}\n                    {!!message.sending && <small> (Sending...)</small>}\n                </div>\n            ))}\n            <form action={formAction} ref={formRef}>\n                <input type=\"text\" name=\"message\" />\n                <button type=\"submit\">Add Message</button>\n            </form>\n        </>\n    )\n}\n\nexport default UseOptimisticComponent;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}